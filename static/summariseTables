#! /usr/bin/env nix-shell
#! nix-shell -i python -p pythonPackages.python pythonPackages.beautifulsoup4
from bs4 import BeautifulSoup
import fileinput

stdin = reduce(lambda content, line: content + line, fileinput.input(), "")
doc   = BeautifulSoup(stdin, 'html.parser')

for summarise in doc.find_all(class_='summarise'):
    for summary in summarise.find_all(class_='summary'):
        summarise.table['summary'] = reduce(
            lambda ttl, txt: ttl + txt,
            summary.strings,
            "").strip()
        remove = True
        for parent in summary.parents:
            if parent == summarise:
                remove = False
            if remove:
                parent.extract()

print(doc)
